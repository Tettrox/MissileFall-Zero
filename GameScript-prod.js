function getRand(a,b){return Math.floor(Math.random()*b+a)}function drawMenus(){if(1!=GameState||2!=GameState)if(0==GameState)GameCanvasCxt.fillStyle="#000000",GameCanvasCxt.fillRect(0,0,GameCanvas.width,GameCanvas.height),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="15px Lucida Console",GameCanvasCxt.drawImage(document.getElementById("GameLogo"),GameCanvas.width/4,20),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/4,80,150,60),GameCanvasCxt.fillText("[START]",120,100),GameCanvasCxt.fillText("[ABOUT]",120,115),GameCanvasCxt.fillText("[OPTIONS]",110,130);else if(4==GameState)if("CORE_SELECT"==MenuID)GameCanvasCxt.fillStyle="#000000",GameCanvasCxt.fillRect(0,0,GameCanvas.width,GameCanvas.height),GameCanvasCxt.fillStyle="#00FFFF",GameCanvasCxt.font="10px Lucida Console",GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,15,10,275,140),GameCanvasCxt.fillText("SELECT_TARGET_CORE",95,45),GameCanvasCxt.fillText("CORE01:[CORRUPTED]",30,75),GameCanvasCxt.fillText("CORE02:ILLUSIONS",160,75),GameCanvasCxt.fillText("CORE03:AXIOM",30,95),GameCanvasCxt.fillText("CORE04:SYS_THREAD",160,95),GameCanvasCxt.fillText("CORE05:INSIDE",30,115),GameCanvasCxt.fillText("CORE06:SELF-DESTRUCT",160,115),GameCanvasCxt.fillText("CORE07:[UNDEFINED]",95,135);else if("ABOUT"==MenuID){GameCanvasCxt.fillStyle="#00FFFF",GameCanvasCxt.font="10px Lucida Console";for(var a=10,b=["MissileFall: Zero is a passion project of mine","that tells the story of what was happening on","Earth while the MissileFall project was taking","place.\nFor the uninitiated, the MissileFall","project takes place many years in the future","in a world completely overrun by pollution,","and in an attempt to find another planet","inhabbitable by humans, the United Nations","and most other countries sent their leaders,","diplomats, and smartest citizens into space."],c=0;c<b.length;c++)GameCanvasCxt.fillText(b[c],15,c*a+4*a);GameCanvasCxt.font="20px Lucida Console",GameCanvasCxt.fillText("-=ABOUT=-",95,15)}else if("GAMEMODE_SELECT"==MenuID)GameCanvasCxt.fillStyle="#000000",GameCanvasCxt.fillRect(0,0,GameCanvas.width,GameCanvas.height),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,15,10,275,140),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="20px Courier New",GameCanvasCxt.fillText("SELECT_LOG_MODE",55,45),GameCanvasCxt.fillText("[STORY]",105,95),GameCanvasCxt.fillText("[SURVIVAL]",85,125);else if("OPTIONS"==MenuID){GameCanvasCxt.fillStyle="#000000",GameCanvasCxt.fillRect(0,0,GameCanvas.width,GameCanvas.height),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="16px Courier New",GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,15,10,275,140),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,88,72,32,88,55,122,32),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,88,72,32,88,88,122,32),GameCanvasCxt.fillText("-=CONFIGURATION=-",68,45),GameCanvasCxt.font="11px Courier New",GameCanvasCxt.fillText("MUSIC",132,67),GameCanvasCxt.fillText("SOUND_FX",120,100),GameCanvasCxt.fillText("[8]RETURN",115,135),GameCanvasCxt.font="8px Courier New",GameCanvasCxt.fillText("LOW",100,73),GameCanvasCxt.fillText("MEDIUM",120,73),GameCanvasCxt.fillText("HIGH",155,73),GameCanvasCxt.fillText("OFF",180,73),GameCanvasCxt.fillText("LOW",100,106),GameCanvasCxt.fillText("MEDIUM",120,106),GameCanvasCxt.fillText("HIGH",155,106),GameCanvasCxt.fillText("OFF",180,106),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,103,73,11,11),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,130,73,11,11),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,160,73,11,11),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,182,73,11,11);var d=document.getElementById("GameMusic");switch(PlayMusic){case 0:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,182,73,13,11),d.volume=0;break;case 1:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,103,73,13,11),d.volume=.2;break;case 2:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,130,73,13,11),d.volume=.5;break;case 3:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,160,73,13,11),d.volume=1;break;default:PlayMusic=0}switch(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,103,106,11,11),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,130,106,11,11),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,160,106,11,11),GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),482,337,13,13,182,106,11,11),PlaySFX){case 0:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,103,106,13,11);break;case 1:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,130,106,13,11);break;case 2:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,160,106,13,11);break;case 3:GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),329,225,13,13,182,106,13,11);break;default:PlaySFX=0}}}function drawDialog(){if(1==GameMode){var a=Math.floor(12*Math.random()-6),b=Math.floor(4*Math.random()-2);switch(SubGameMode){case 2:CutsceneFrames<20?(EnemySpawning=0,GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),171,299,50,50,GameCanvas.width/6+a,GameCanvas.height-GameCanvas.height/3+b,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("BEHOLD! THE VOICE OF GOD!",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("REPENT AND FACE JUSTICE",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("FOR YOUR UNHOLY EXISTENCE!",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<40?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),171,299,50,50,GameCanvas.width/6+a,GameCanvas.height-GameCanvas.height/3+b,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("YOU DARE REJECT THE WILL",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("OF GOD?! THEN DIE BY THE",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("HAND OF YOUR OWN SINS!",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10),EnemySpawning=1):CutsceneFrames<60?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),171,299,50,50,GameCanvas.width/6+a,GameCanvas.height-GameCanvas.height/3+b,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("YOU RUN AS IF YOUR",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("ACTIONS WILL CHANGE YOUR",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("FATE! YOU WILL SUBMIT!",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<80?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),171,299,50,50,GameCanvas.width/6+a,GameCanvas.height-GameCanvas.height/3+b,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("MAY THOSE WHO FELL",GameCanvas.width/3.8,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("BEFORE YOU CRUSH",GameCanvas.width/3.8,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("YOU FROM WITHIN!!",GameCanvas.width/3.8,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<100?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),171,299,50,50,GameCanvas.width/6+a,GameCanvas.height-GameCanvas.height/3+b,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("YOU CAN RUN FOREVER, BUT",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/6),GameCanvasCxt.fillText("YOUR FATE IS SEALED!",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8)):CutsceneFrames<110&&(SubGameMode=0,MenuID="CORE_SELECT",GameState=4,clearInterval(CutsceneTimer),CutsceneFrames=0,Entities[findPlayer()].EntityHealth=3);break;case 3:CutsceneFrames<20?(EnemySpawning=0,GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("I've thought about it",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("more, this artificial",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("world.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<40?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("At first, I wanted",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("simply to cleanse you",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("from this world for",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10),GameCanvasCxt.fillText("refusing reality.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/20)):CutsceneFrames<60?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("But now I realize",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("that I can fix all of",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("this. I have unlimited",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("power to create and destroy.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<80?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),184,368,24,24,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("I wIlL cReAtE a",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("CoMpLeTeLy SiNlEsS",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("wOrLd!",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),EnemySpawning=1):CutsceneFrames<180?(EnemySpawning=0,GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("How do you go on,",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("knowing how it will",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("end? Why do you fight",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("a losing battle?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<200?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Have you ever looked",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("at the Yin/Yang sign?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("On one side, pitch black.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("The other, pure white.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<220?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("There is no center.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("It's an axiom. Only",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("one extreme or the",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("other.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<240?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("No matter what happens",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("today, I will die",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("eventually, either here,",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("by you, or by something else.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<260?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Either way, it's an",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("unavoidable extreme.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8)):CutsceneFrames<280?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Then why do you refuse",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("to die here?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("Would it not be easier?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12)):CutceneFrames<300?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("It would be. They say",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("always take the enemy",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("you know over the one",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("you don't.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<320?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("But that's why I will",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("never stop fighting you:",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("Because I know who you are.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12)):CutsceneFrames<340?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("And if I'm going to",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("die, I will do my",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("damndest to make sure",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("it isn't by your hand.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<360?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Not for you, not for",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("anyone else, but for me.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8)):CutsceneFrames<380?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("You've dealt more damage",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("to me than death ever",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/8),GameCanvasCxt.fillText("could, but like Hell will",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/12),GameCanvasCxt.fillText("I let you do the final blow.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/22)):CutsceneFrames<390?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Well, I've come to the",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("conclusion that, since this",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("world is now only rubble,",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<405?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("I will start from scratch.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("May you rot with the world of sin",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("you so desprately clutch to.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<415?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("The corruption will",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("finish of what is left of",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("your will.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<425&&(SubGameMode=0,clearInterval(CutsceneTimer),CutsceneFrames=0,MenuID="CORE_SELECT",GameState=4,EnemySpawning=0,Entities[findPlayer()].EntityHealth=3);break;case 4:CutsceneFrames<3?(Entities[findPlayer()].XLoc=128,Entities[findEntity("SNR")].XVel=-.4):Entities[findEntity("SNR")].XVel=0,CutsceneFrames<6&&CutsceneFrames>3?(Entities[findPlayer()].AnimationSet=0,GameCanvasCxt.fillStyle="#FFF600",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("I know this has been",123,100),GameCanvasCxt.fillText("rough on you, lately.",123,106)):CutsceneFrames<10&&CutsceneFrames>6?(GameCanvasCxt.fillStyle="#FFF600",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Watching the whole",123,100),GameCanvasCxt.fillText("world be crushed...",123,106)):CutsceneFrames<14&&CutsceneFrames>10?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("You have no idea.",100,100),GameCanvasCxt.fillText("But talking won't fix it.",100,106)):CutsceneFrames<18&&CutsceneFrames>14?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("What do you want?",100,106)):CutsceneFrames<22&&CutsceneFrames>18?(GameCanvasCxt.fillStyle="#FFF600",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("To give you a chance",123,100),GameCanvasCxt.fillText("to start over.",123,106)):CutsceneFrames<26&&CutsceneFrames>22?(GameCanvasCxt.fillStyle="#FFF600",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("We found something",123,100),GameCanvasCxt.fillText("that will let us make",123,106),GameCanvasCxt.fillText("a new world. A safe one.",123,112)):CutsceneFrames<30&&CutsceneFrames>26?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Assuming you are safe",100,100),GameCanvasCxt.fillText("is the first step to",100,106),GameCanvasCxt.fillText("danger.",100,112)):CutsceneFrames<34&&CutsceneFrames>30?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("And what about the others?",100,100),GameCanvasCxt.fillText("We've lost contact with",100,106),GameCanvasCxt.fillText("so many...",100,112)):CutsceneFrames<38&&CutsceneFrames>34?(GameCanvasCxt.fillStyle="#FFF600",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("We've found some people",123,100),GameCanvasCxt.fillText("from another world. They",123,106),GameCanvasCxt.fillText("will be coming along.",123,112)):CutsceneFrames<42&&CutsceneFrames>38?(GameCanvasCxt.fillStyle="#FFF600",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("We can only hope that",123,100),GameCanvasCxt.fillText("those that we lost are",123,106),GameCanvasCxt.fillText("doing alright.",123,112)):CutsceneFrames<46&&CutsceneFrames>42?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("I no longer believe in hope.",100,100),GameCanvasCxt.fillText("Hope is to willingly deny",100,106),GameCanvasCxt.fillText("yourself of a possible truth.",100,112)):CutsceneFrames<50&&CutsceneFrames>46?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("We don't know what is beyond",85,100),GameCanvasCxt.fillText("this plane of existence. Possibly",65,106),GameCanvasCxt.fillText("a God, or simply void.",85,112)):CutsceneFrames<54&&CutsceneFrames>50?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("I do know what it offers, though.",100,100),GameCanvasCxt.fillText("Release.",100,106)):CutsceneFrames<58&&CutsceneFrames>54?(GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Maybe you will be able to",100,100),GameCanvasCxt.fillText("recreate what once gave me hope,",65,106),GameCanvasCxt.fillText("but I cannot take that chance.",100,112)):CutsceneFrames<62&&CutsceneFrames>58?Entities[findPlayer()].XVel=-.2:CutsceneFrames<66&&CutsceneFrames>62?(Entities[findPlayer()].XVel=0,GameCanvasCxt.fillStyle="#828282",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Don't build a kingdom",Entities[findPlayer()].XLoc-15,100),GameCanvasCxt.fillText("with ash while the wind",Entities[findPlayer()].XLoc-15,106),GameCanvasCxt.fillText("still blows.",Entities[findPlayer()].XLoc-15,112)):CutsceneFrames<70&&CutsceneFrames>66?Entities[findPlayer()].XVel=-.2:CutsceneFrames<75&&CutsceneFrames>70&&(MenuID="CORE_SELECT",GameState=4,Entities.splice(findEntity("SNR"),1),GameCanvasCxt.globalAlpha=1,clearInterval(CutsceneTimer),CutsceneFrames=0,SubGameMode=0,Entities[findPlayer()].EntityHealth=3);break;case 5:CutsceneFrames<3?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Man, you're odd.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("You fight this meaningless",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("war, and for what?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<10?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("So you can pretend",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("like you matter for",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("some reason?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<15?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("You mean NOTHING.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("Do you even know",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("what reality is anymore?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<25?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("As far as you know,",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("as soon as you die,",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("so does the world.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<35?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Yet here we are.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("You dodging bullets",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("for people you think are real.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<45?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Actually, you know what?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("Prove it. Prove you're in",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("the 'real' world.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10),EnemySpawning=0,setLock(1,1)):CutsceneFrames<50?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Go ahead, take your",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("time. I'll wait.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7)):CutsceneFrames<60?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("You can't do it.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("But you can prove God exists, right?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("Or, perhaps, that he doesn't?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10),EnemySpawning=1,setLock(0,0)):CutsceneFrames<75?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Once again, you can't do it.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("You don't even know the basics",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("of how you came to exist.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<85?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("All you have is fables",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("and theories. Myths and",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("guesses.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<95?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Can you honestly tell",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("yourself that the",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("universe cares if you exist?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<105?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("That you have some",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("purpose in life?",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7)):CutsceneFrames<115?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("But the best part is the",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("irony of it all. The most",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("hilarious part.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<125?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("Even if you lived",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("forever, you'll never",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("know the answer.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<135?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("You are less than",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("a pawn in a game you",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("don't know how to play.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<145&&(SubGameMode=0,MenuID="CORE_SELECT",GameState=4,Entities[findPlayer()].EntityHealth=3);break;case 6:CutsceneFrames<8?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",
GameCanvasCxt.fillText("Once more into the.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("fray, I see.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),EnemySpawning=1):CutsceneFrames<16?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("You know, this would have",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("eventually happened anyway.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("Even without him.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<24?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("I honestly thought",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("you would be dead by",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("now.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<32?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("But once again,",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("you prove your",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("persistence.",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<40?(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.font="6px 'Press Start 2P'",GameCanvasCxt.fillText("ENOUGH OF THESE",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/5),GameCanvasCxt.fillText("MIND GAMES, WHO THE",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/7),GameCanvasCxt.fillText("HELL ARE YOU?!",GameCanvas.width/4,GameCanvas.height-GameCanvas.height/10)):CutsceneFrames<52&&(GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),168,120,72,32,GameCanvas.width/6,GameCanvas.height-GameCanvas.height/3,200,50),GameCanvasCxt.fillStyle="#FFF400",GameCanvasCxt.font="20px 'Press Start 2P'",clearInterval(EnemySpawner),EnemySpawner=setInterval(spawnEnemy,1332),GameCanvasCxt.fillText("I AM",GameCanvas.width/5,GameCanvas.height-GameCanvas.height/9),GameCanvasCxt.fillStyle="#00FF00",GameCanvasCxt.fillText("YOU!",GameCanvas.width/2,GameCanvas.height-GameCanvas.height/9))}}}function drawScreen(){for(var a=0;a<Entities.length;a++)"BackgroundFireball"==Entities[a].EntityTag&&6!=SubGameMode&&GameCanvasCxt.drawImage(Entities[a].getSprite(),Entities[a].ClipX,Entities[a].ClipY,Entities[a].EntityWidth,Entities[a].EntityHeight,Entities[a].getXLoc(),Entities[a].getYLoc(),Entities[a].EntityWidth,Entities[a].EntityHeight);if(1==GameState)if(GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="30px 'Press Start 2P'",2==SubGameMode)GameCanvasCxt.drawImage(document.getElementById("SUNSET_TESTBG"),0,0);else if(4==SubGameMode)GameCanvasCxt.drawImage(document.getElementById("SYSTEMTHREAD_BG"),-15,-40);else if(6==SubGameMode){GameCanvasCxt.fillText(SelfDestructList[getRand(0,SelfDestructList.length)],getRand(0,GameCanvas.width),getRand(0,GameCanvas.height));var b=getRand(1,3);GameCanvasCxt.lineWidth=5,1==b?GameCanvasCxt.strokeStyle="#00FF00":2==b?GameCanvasCxt.strokeStyle="#0000FF":GameCanvasCxt.strokeStyle="#FF0000",GameCanvasCxt.strokeRect(getRand(0,GameCanvas.width),getRand(0,GameCanvas.height),getRand(50,100),getRand(50,100)),GameCanvasCxt.lineWidth=2,GameCanvasCxt.beginPath(),GameCanvasCxt.moveTo(getRand(0,GameCanvas.width),getRand(0,GameCanvas.height)),GameCanvasCxt.lineTo(getRand(0,GameCanvas.width),getRand(0,GameCanvas.height)),GameCanvasCxt.stroke(),GameCanvasCxt.closePath()}drawMenus();for(var a=0;a<Entities.length;a++)1==Entities[a].isGlitched?GameCanvasCxt.drawImage(Entities[a].getSprite(),getRand(1,346),getRand(1,853),Entities[a].EntityWidth,Entities[a].EntityHeight,Entities[a].getXLoc(),Entities[a].getYLoc(),Entities[a].EntityWidth,Entities[a].EntityHeight):"BackgroundFireball"!=Entities[a].EntityTag&&"Player"!=Entities[a].EntityTag&&GameCanvasCxt.drawImage(Entities[a].getSprite(),Entities[a].ClipX,Entities[a].ClipY,Entities[a].EntityWidth,Entities[a].EntityHeight,Entities[a].getXLoc(),Entities[a].getYLoc(),Entities[a].EntityWidth,Entities[a].EntityHeight);if(1==GameState){for(var a=0;a<Entities[findPlayer()].EntityHealth;a++)4!=SubGameMode&&GameCanvasCxt.drawImage(document.getElementById("GUI_FULL"),104,9,16,14,16*a,0,16,14);GameCanvasCxt.drawImage(Entities[findPlayer()].getSprite(),Entities[findPlayer()].ClipX,Entities[findPlayer()].ClipY,Entities[findPlayer()].EntityWidth,Entities[findPlayer()].EntityHeight,Entities[findPlayer()].getXLoc(),Entities[findPlayer()].getYLoc(),Entities[findPlayer()].EntityWidth,Entities[findPlayer()].EntityHeight)}if(1==StaticFrame?(4==SubGameMode&&(GameCanvasCxt.globalAlpha=.5),GameCanvasCxt.drawImage(document.getElementById("SCREENEFFECT_STATIC1"),0,0,800,600),GameCanvasCxt.globalAlpha=1,StaticFrame+=1):2==StaticFrame?(4==SubGameMode&&(GameCanvasCxt.globalAlpha=.5),GameCanvasCxt.drawImage(document.getElementById("SCREENEFFECT_STATIC2"),0,0,800,600),GameCanvasCxt.globalAlpha=1,StaticFrame+=1):3==StaticFrame?(4==SubGameMode&&(GameCanvasCxt.globalAlpha=.5),GameCanvasCxt.drawImage(document.getElementById("SCREENEFFECT_STATIC3"),0,0,800,600),GameCanvasCxt.globalAlpha=1,StaticFrame+=1):(4==SubGameMode&&(GameCanvasCxt.globalAlpha=.5),GameCanvasCxt.drawImage(document.getElementById("SCREENEFFECT_STATIC4"),0,0,800,600),GameCanvasCxt.globalAlpha=1,StaticFrame=1),drawDialog(),GameCanvasCxt.fillStyle="#0000FF",GameCanvasCxt.font="30px Arial",5==GameState){GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.font="8px 'Courier New'",GameCanvasCxt.fillText("¿niw yllɒɘɿ ɘnoynɒ nɒƆ",GameCanvas.width/3,GameCanvas.height/2.8);var c=GameCanvasCxt.createLinearGradient(GameCanvas.width/3.85,GameCanvas.height/3.5,GameCanvas.width/3.85,GameCanvas.height/3.5-16);c.addColorStop(1,"#FF0000"),c.addColorStop(0,"#FFFF00"),GameCanvasCxt.fillStyle=c,GameCanvasCxt.font="16px 'Press Start 2P'",GameCanvasCxt.fillText("GAME OVER",GameCanvas.width/3.85,GameCanvas.height/3.5)}}function findPlayer(){for(var a=0;a<Entities.length;a++)if("Player"==Entities[a].EntityTag)return a;return console.log("**WARNING**: Player not found in Entity array. Defaulting to first element."),0}function findEntity(a){for(var b=0;b<Entities.length;b++)if(Entities[b].EntityTag==a)return b;return console.log("Failed to locate entity "+a+"."),1}function readControlsDown(a){var b=a.keyCode;switch(b){case 87:break;case 65:1!=ControlsLocked&&(Entities[findPlayer()].XVel=-Entities[findPlayer()].EntitySpeed,Entities[findPlayer()].updatePlayerASet("Left"));break;case 83:break;case 68:1!=ControlsLocked&&(Entities[findPlayer()].XVel=Entities[findPlayer()].EntitySpeed,Entities[findPlayer()].updatePlayerASet("Right"));break;case 32:"Pistol"!=Entities[findPlayer()].CurrentWeapon&&(Entities[findPlayer()].isShooting=1)}}function generateLivePlatform(){if(1==GameState&&4!=SubGameMode){for(var a=0,b=0,c=0;c<Entities.length;c++)"BlockBar"==Entities[c].EntityTag&&(a+=1);if(a<_MAXBARS){for(var d=0;d<Entities.length;d++)"BlockBar"==Entities[d].EntityTag&&(b=Entities[d].getYLoc());Entities.push(new f(0,b+_YBARSPACER,getRand(25,120),0)),Entities.push(new f(Entities[Entities.length-1].EntityWidth+_XBARSPACER,Entities[Entities.length-1].getYLoc(),Entities[Entities.length-1].EntityWidth+100,1))}}}function doCollisions(){for(var a=0;a<Entities.length;a++){"EnemyGrunt"==Entities[a].EntityTag?Entities[a].YVel=GravityForce:"EnemyBrute"==Entities[a].EntityTag&&(Entities[a].YVel=GravityForce);for(var b=0;b<Entities.length;b++)Entities[a].XLoc<Entities[b].XLoc+Entities[b].EntityWidth&&Entities[a].XLoc+Entities[a].EntityWidth>Entities[b].XLoc&&Entities[a].YLoc<Entities[b].YLoc+Entities[b].EntityHeight&&Entities[a].YLoc+Entities[a].EntityHeight>Entities[b].YLoc&&("Player"==Entities[a].EntityTag?("BlockBar"==Entities[b].EntityTag?(clearInterval(Entities[findPlayer()].jumpTimer),Entities[a].jumpFrame=0,Entities[a].YLoc>Entities[b].YLoc||(Entities[a].YLoc=Entities[b].YLoc-Entities[a].EntityHeight,Entities[a].YVel=Entities[b].YVel)):0==Entities[a].jumpFrame&&4!=SubGameMode&&(Entities[a].YVel=GravityForce),"EnemyGrunt"==Entities[b].EntityTag&&(Entities[a].EntityHealth-=Entities[b].EntityDamage,Entities.splice(b,1))):"EnemyGrunt"==Entities[a].EntityTag?"BlockBar"==Entities[b].EntityTag&&(Entities[a].YLoc=Entities[b].getYLoc()-Entities[a].EntityHeight,Entities[a].YVel=Entities[b].YVel):"PlayerBullet"==Entities[a].EntityTag?"EnemyGrunt"==Entities[b].EntityTag?(Entities[b].EntityHealth-=1,Entities[a].XLoc=1e3):"EnemyBrute"==Entities[b].EntityTag&&(Entities[b].EntityHealth-=1,Entities[a].XLoc=1e3):"EnemyBrute"==Entities[a].EntityTag&&("BlockBar"==Entities[b].EntityTag?(Entities[a].YVel=Entities[b].YVel,Entities[a].YLoc=Entities[b].YLoc-Entities[a].EntityHeight):"Player"==Entities[b].EntityTag&&(Entities[b].XVel=1.2*Entities[a].XVel)))}}function GarbageCollector(){for(var a=0;a<Entities.length;a++)0==Entities[a].GarbageMethod?Entities[a].getYLoc()<-10&&Entities.splice(a,1):1==Entities[a].GarbageMethod?Entities[a].getYLoc()>GameCanvas.height&&Entities.splice(a,1):2==Entities[a].GarbageMethod?(Entities[a].getYLoc()>GameCanvas.height||Entities[a].getYLoc()<-10)&&Entities.splice(a,1):3==Entities[a].GarbageMethod?Entities[a].getXLoc()>GameCanvas.width&&Entities.splice(a,1):4==Entities[a].GarbageMethod?Entities[a].getXLoc()<0&&Entities.splice(a,1):5==Entities[a].GarbageMethod?(Entities[a].getXLoc()<0||Entities[a].getXLoc()>GameCanvas.width||Entities[a].getYLoc()>GameCanvas.height||Entities[a].getYLoc()<-10)&&Entities.splice(a,1):6==Entities[a].GarbageMethod?(Entities[a].getXLoc()<0||Entities[a].getXLoc()>GameCanvas.width||Entities[a].getYLoc()>GameCanvas.height||Entities[a].getYLoc()<-10||Entities[a].EntityHealth<1)&&Entities.splice(a,1):7==Entities[a].GarbageMethod?(Entities[a].getYLoc()<-10||Entities[a].getYLoc()>GameCanvas.height||Entities[a].EntityHealth<1)&&Entities.splice(a,1):Entities[a].GarbageMethod!=-1&&console.log("**WARNING**: Unknown garbage collection method on entity ID "+Entities[a].EntityTag+" in cell "+a+" of Entities")}function doMusicGen(){GameCanvasCxt.crossOrigin="Annonymous";var a=GameCanvasCxt.getImageData(0,0,GameCanvas.width,GameCanvas.height);MusicGenPixels=a.data;for(var b=0;b<Math.floor(MusicGenPixels.length/8);b++)AudioGen.frequency.value=MusicGenPixels[b]}function GameLoop(){1==GameState&&generateLivePlatform(),drawScreen();for(var a=0;a<Entities.length;a++)"Player"==Entities[a].EntityTag?(Entities[a].YLoc>0&&Entities[a].YLoc<GameCanvas.height?Entities[a].YLoc+=Entities[a].YVel:Entities[a].YLoc=1,Entities[a].XLoc>0&&Entities[a].XLoc<GameCanvas.width?Entities[a].XLoc+=Entities[a].XVel:Entities[a].XLoc=1,Entities[a].XLoc<0&&(Entities[a].XLoc=GameCanvas.width-Entities[a].EntityWidth),Entities[a].doAI(),Entities[a].EntityHealth<0&&doGameOver()):0==Entities[a].Locked&&(Entities[a].doAI(),Entities[a].XLoc+=Entities[a].XVel,Entities[a].YLoc+=Entities[a].YVel);doCollisions(),GarbageCollector()}function generateLevel(){Entities.push(new f(0,getRand(0,100),getRand(1,150),0)),Entities.push(new f(Entities[Entities.length-1].EntityWidth+_XBARSPACER,Entities[Entities.length-1].getYLoc(),Entities[Entities.length-1].EntityWidth+GameCanvas.width,1))}function initClasses(){}function spawnEnemy(){if(1==GameState&&1==EnemySpawning){var a=getRand(0,2);0==a?Entities.push(new h(Math.floor(Math.random()*GameCanvas.width),Math.floor(Math.random()*GameCanvas.height),"EnemyGrunt")):Entities.push(new h(Math.floor(Math.random()*GameCanvas.width),Math.floor(Math.random()*GameCanvas.height),"EnemyBrute"))}}function TESTFUNC(){console.log("Test complete.")}function countCutsceneFrames(){1==GameMode&&(CutsceneFrames+=1)}function doMenuInput(a){var b="";switch(a){case 49:b="1";break;case 50:b="2";break;case 51:b="3";break;case 52:b="4";break;case 53:b="5";break;case 54:b="6";break;case 55:b="7";break;case 56:b="8";break;case 57:b="9";break;case 58:b="0"}if("NONE"!=MenuID)if("STARTMENU"==MenuID)"1"==b?(GameState=4,MenuID="GAMEMODE_SELECT"):"2"==b?(MenuID="ABOUT",GameState=4):"3"==b&&(MenuID="OPTIONS",GameState=4);else if("GAMEMODE_SELECT"==MenuID)"1"==b?MenuID="CORE_SELECT":"2"==b&&(MenuID="NONE",GameState=1,GameMode=2);else if("CORE_SELECT"==MenuID)switch(b){case"1":break;case"2":console.log("LOADING:CORE02"),GameMode=1,GameState=1,MenuID="NONE",SubGameMode=2,CutsceneTimer=setInterval(countCutsceneFrames,1e3),generateLivePlatform(),setMusic("MAINGAME"),EnemySpawning=1;break;case"3":console.log("LOADING:CORE03"),setMusic("PEACEFUL"),GameState=1,GameMode=1,SubGameMode=3,CutsceneTimer=setInterval(countCutsceneFrames,1e3),generateLivePlatform(),MenuID="NONE",EnemySpawning=0;break;case"4":Entities[findPlayer()].YLoc=115,Entities[findPlayer()].XLoc=250,console.log("LOADING:CORE04"),setMusic("SYSTEMTHREAD"),GameMode=1,GameState=1,MenuID="NONE",SubGameMode=4,CutsceneTimer=setInterval(countCutsceneFrames,1e3),EnemySpawning=0,Entities[findPlayer()].YVel=0,Entities[findPlayer()].AnimationSet=1,ControlsLocked=1;break;case"5":console.log("LOADING:CORE05"),setMusic("MAINGAME"),MenuID="NONE",GameState=1,GameMode=1,SubGameMode=5,CutsceneTimer=setInterval(countCutsceneFrames,1e3),EnemySpawning=1;break;case"6":console.log("LOADING:CORE06"),setMusic("MAINGAME"),MenuID="NONE",GameState=1,GameMode=1,SubGameMode=6,CutsceneTimer=setInterval(countCutsceneFrames,1e3),EnemySpawning=0;break;case"7":console.log("LOADING:CORE07"),setMusic("MAINGAME");break;case"8":console.log("LOADING:CORE08"),setMusic("MAINGAME"),console.log("(؛ ˙ʇɐdʇɐɯ 'buıʇıɐʍ ǝq ןן,ı")}else if("ABOUT"==MenuID)"1"==b&&(GameState=0,MenuID="STARTMENU");else if("OPTIONS"==MenuID)switch(b){case"1":PlayMusic<4?PlayMusic+=1:PlayMusic=0;break;case"2":PlaySFX<4?PlaySFX+=1:PlaySFX=0;break;case"3":break;case"8":GameState=0,MenuID="STARTMENU"}}function readControlsUp(a){var b=a.keyCode;switch(b){case 87:0==Entities[findPlayer()].jumpFrame&&(Entities[findPlayer()].jumpFrame=1,4!=SubGameMode&&(Entities[findPlayer()].YVel=-(GravityForce/1.5)),Entities[findPlayer()].jumpTimer=setInterval(Entities[findPlayer()].updateJumpFrame,350));break;case 65:1!=ControlsLocked&&(Entities[findPlayer()].XVel=0,Entities[findPlayer()].updatePlayerASet("Left"));break;case 83:break;case 68:1!=ControlsLocked&&(Entities[findPlayer()].XVel=0,Entities[findPlayer()].updatePlayerASet("Right"));break;case 32:1!=ControlsLocked&&(Entities[findPlayer()].isShooting=0,Entities[findPlayer()].firePlayerWeapon());break;case 16:break;case 27:2!=GameState?(setLock(1),GameState=2):(setLock(0),GameState=1);break;case 13:5==GameState&&(clearInterval(CutsceneTimer),CutsceneFrames=0,CutsceneTimer=setInterval(countCutsceneFrames,1e3),GameState=1,Entities[findPlayer()].EntityHealth=3,setLock(0));break;default:doMenuInput(b)}}function updateMouseCords(a){_MOUSEX=a.clientX,_MOUSEY=a.clientY}function setMusic(a){var b=document.getElementById("GameMusic");"STARTMENU"==a?b.src="Audio/Music/STARTMENU.mp3":"SYSTEMTHREAD"==a?b.src="Audio/Music/SYSTEMTHREAD.mp3":"MAINGAME"==a?b.src="Audio/Music/MAINGAME.mp3":"PEACEFUL"==a&&(b.src="Audio/Music/PEACEFUL.ogg"),b.play()}function setLock(a,b=0){for(var c=0;c<Entities.length;c++)"Player"!=Entities[c].EntityTag?Entities[c].Locked=a:0==b&&"Player"==Entities[c].EntityTag&&(Entities[c].Locked=a)}function doGameOver(){GameState=5,setLock(1),clearInterval(CutsceneTimer),CutsceneFrames=0}function initGame(){console.log("-=Loading Copland OS Enterprise=-"),console.log("Initializing classes..."),initClasses(),Entities.push(new c),Entities.push(new j),Entities.push(new j),Entities.push(new j),console.log("Starting game loop..."),setInterval(GameLoop,10),console.log("Retrieving canvas element..."),GameCanvas=document.getElementById("GameCanvas"),GameCanvasCxt=GameCanvas.getContext("2d"),console.log("Adding keyboard event listeners..."),document.addEventListener("keydown",readControlsDown,!1),document.addEventListener("keyup",readControlsUp,!1),GameCanvasCxt.imageSmoothingEnabled=!1,GameCanvasCxt.fillStyle="#FF0000",GameCanvasCxt.fillRect(0,0,GameCanvas.width,GameCanvas.height),GameCanvasCxt.fillStyle="#0000FF",GameCanvasCxt.font="30px Arial",GameCanvasCxt.fillText("HELLO, NAVI.",10,50),GameCanvasCxt.drawImage(Entities[0].getSprite(),0,0),console.log("Login accepted. Hello, Lain."),RRSound=new Audio("Audio/RRNoise.ogg"),RRSound.addEventListener("timeupdate",function(){var a=1;this.currentTime>this.duration-a&&(this.currentTime=0,this.play())},!1),document.getElementById("GameMusic").addEventListener("timeupdate",function(){var a=1;this.currentTime>this.duration-a&&(this.currentTime=0,this.play())},!1),Entities.push(new d),RRSound.play()}var GameCanvas,GameCanvasCxt,GameState=0,GameMode=2,MenuID="STARTMENU",SubGameMode=0,CutsceneFrames=0,CutsceneTimer=0,ControlsLocked=0;Entities=[],EnemiesList=["EnemyGrunt"],SelfDestructList=["Depression","Hope","Peace","War","Revolution","Loss","Death","Life","Purpose","Sadness","Despair","LAIN","Drugs","Violence","Fear","Anger","Rage","Hate"];var RRSound,GravityForce=2,_XBARSPACER=70,_YBARSPACER=80,_MAXBARS=8,EnemySpawner=setInterval(spawnEnemy,3223),EnemySpawning=1,StaticFrame=1,_MOUSEX=0,_MOUSEY=0,PlayMusic=2,PlaySFX=0,UseShaders=0,AudioCtx=new window.AudioContext,AudioGen=AudioCtx.createOscillator(),AudioVol=AudioCtx.createGain(),MusicGenPixels=[],DialogSize=0,DialogEnd=0;class a{constructor(a,b){this.XLoc=a,this.YLoc=b}getXLoc(){return this.XLoc}getYLoc(){return this.YLoc}}class b{constructor(){this.EntityTag="UnknownEntity",this.EntityDamage=0,this.EntityHealth=1,this.isGlitched=0,this.SprLoc=document.getElementById("ENTITIES_FULL"),this.AnimationTimer=-1,this.AnimationSet=0,this.AnimationFrame=0,this.AnimationFrameMax=2,this.AS_Left=[],this.AS_Right=[],this.AS_Up=[],this.AS_Down=[],this.XLoc=0,this.YLoc=1,this.XVel=0,this.YVel=0,this.EntitySpeed=0,this.Locked=0,this.EntityWidth=0,this.EntityHeight=0,this.ClipX=0,this.ClipY=0,this.GarbageMethod=-1}getSprite(){return this.SprLoc}getXLoc(){return this.XLoc}getYLoc(){return this.YLoc}doAI(){}AnimateSprite(){if(0!=this.AnimationSet)if(1==this.AnimationSet)this.AnimationFrame<this.AnimationFrameMax?(this.ClipX=this.AS_Left[this.AnimationFrame].XLoc,this.ClipY=this.AS_Left[this.AnimationFrame].YLoc,this.AnimationFrame+=1):this.AnimationFrame=0;else if(2==this.AnimationSet)this.AnimationFrame<this.AnimationFrameMax?(this.ClipX=this.AS_Right[this.AnimationFrame].XLoc,this.ClipY=this.AS_Right[this.AnimationFrame].YLoc,this.AnimationFrame+=1):this.AnimationFrame=0;else if(3==this.AnimationSet)this.AnimationFrame<this.AnimationFrameMax?(this.ClipX=this.AS_Up[this.AnimationFrame].XLoc,this.ClipY=this.AS_Up[this.AnimationFrame].YLoc,this.AnimationFrame+=1):this.AnimationFrame=0;else if(4==this.AnimationSet)this.AnimationFrame<this.AnimationFrameMax?(this.ClipX=this.AS_Down[this.AnimationFrame].XLoc,this.ClipY=this.AS_Down[this.AnimationFrame].YLoc,this.AnimationFrame+=1):this.AnimationFrame=0;else if(5==this.AnimationSet)this.AnimationFrame<this.AnimationFrameMax?(this.ClipX=this.AS_Hurt[this.AnimationFrame].XLoc,this.ClipY=this.AS_Hurt[this.AnimationFrame].YLoc,this.AnimationFrame+=1):this.AnimationFrame=0;else if("Player"==this.EntityTag){var a=[];6==this.AnimationSet?a=this.AS_Pistol_Left:7==this.AnimationSet?a=this.AS_Pistol_Right:8==this.AnimationSet?a=this.AS_Shotgun_Left:9==this.AnimationSet?a=this.AS_Shotgun_Right:10==this.AnimationSet?a=this.AS_PistolShield_Left:11==this.AnimationSet?a=this.AS_PistolShield_Right:12==this.AnimationSet?a=this.AS_MachineGun_Left:13==this.AnimationSet&&(a=this.AS_MachineGun_Right),this.AnimationFrame<this.AnimationFrameMax?(this.ClipX=a[this.AnimationFrame].XLoc,this.ClipY=a[this.AnimationFrame].YLoc,this.AnimationFrame+=1):this.AnimationFrame=0}}}class e extends b{constructor(b,c){super(),this.EntityTag="EnemyBrute",this.EntityHealth=3,this.EntitySpeed=2,this.EntityWidth=23,this.EntityHeight=24,this.XLoc=b,this.YLoc=c,this.YVel=GravityForce,this.GarbageMethod=7,this.AnimationSet=1,this.AS_Left=[new a(241,384),new a(266,384)],this.AS_Right=[new a(1274,384),new a(1299,384)],this.AnimateSprite(),this.AnimationTimer=setInterval(this.AnimateSprite.bind(this),250),this.doAI.bind(this)}doAI(){Entities[findPlayer()].YLoc>this.YLoc&&(Entities[findPlayer()].XLoc<this.XLoc?(this.XVel=-this.EntitySpeed,this.AnimationSet=1):(this.AnimationSet=2,this.XVel=this.EntitySpeed)),this.XLoc<5?(this.XVel=this.EntitySpeed,this.AnimationSet=2):this.XLoc>GameCanvas.width-5&&(this.XVel=-this.EntitySpeed,this.AnimationSet=1)}}class g extends b{constructor(b,c){super(),this.EntityTag="EnemyGrunt",this.SprLoc=document.getElementById("ENTITIES_FULL"),this.isGlitched=0,this.EntitySpeed=2,this.XLoc=b,this.YLoc=c,this.XVel=this.EntitySpeed,this.YVel=GravityForce,this.GarbageMethod=7,this.EntityWidth=23,this.EntityHeight=22,this.EntityHealth=2,this.EntityDamage=1,this.AnimationSet=2,this.AnimationFrameMax=2,this.AnimationTimer=setInterval(this.AnimateSprite.bind(this),150),this.AS_Left=[new a(192,554),new a(216,554)],this.AS_Right=[new a(1324,554),new a(1348,554)],this.AnimateSprite(),this.doAI.bind(this)}doAI(){this.XLoc<0?(this.XVel=this.EntitySpeed,this.AnimationSet=2):this.XLoc+this.EntityWidth>GameCanvas.width&&(this.XVel=-this.EntitySpeed,this.AnimationSet=1)}}class h extends b{constructor(b,c,d){super(),this.EntityTag="EnemyPortal",this.XLoc=b,this.YLoc=c,this.isGlitched=1,this.EntityWidth=26,this.EntityHeight=28,this.SprLoc=document.getElementById("ENTITIES_FULL"),this.ClipX=1083,this.ClipY=743,this.YVel=0,this.GarbageMethod=5,this.AnimationSet=1,this.AnimationFrameMax=2,this.AS_Left=[new a(1083,743),new a(1107,743)],this.doAI.bind(this),this.SpawnEnemy=d,this.FramesToSpawn=22,this.FrameCounter=0}doAI(){this.FrameCounter+=1,this.FrameCounter>this.FramesToSpawn&&("EnemyGrunt"==this.SpawnEnemy?Entities.push(new g(this.XLoc,this.YLoc)):"EnemyBrute"==this.SpawnEnemy&&Entities.push(new e(this.XLoc,this.YLoc)),this.XLoc=9999,this.FrameCounter=-1e3)}}